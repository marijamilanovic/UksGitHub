{% extends 'repository/index.html' %}
{% load static %}
{% load bootstrap_icons %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'home/style.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
</head>

<body>
    {% block page_content %}
    <div class="tab-pane container active" id="pullrequests">
    {% if pullrequest %}
    <h2 style="margin-top: -20px;">{{pullrequest.name}}</h2>
    {% if pullrequest.status == 'Opened' %}
        <div class="card-header" style="background-color: #d7f0db;">
            {% bs_icon 'bezier2' size='1em' color='green' %}<span style="padding-left:20px; color: green;"> {{pr.status}}</span> <span style="padding-left:15px">merging commits into {{pullrequest.target.name}} from {{pullrequest.source.name}}</span>  
    </div>
    {% elif pullrequest.status == 'Merged' %}
        <div class="card-header" style="background-color: #e9d7f0;">
            {% bs_icon 'bezier2' size='1em' color='purple' %} <span style="padding-left:15px; color: purple;" >{{pr.status}}</span>  <span style="padding-left:15px">merging commits into {{pullrequest.target.name}} from {{pullrequest.source.name}}</span>  
        </div>
    {% else %}
        <div class="card-header" style="background-color: #f1bebe;">
            {% bs_icon 'pause' size='1em' color='red' %} <span style="padding-left:15px; color: red;">{{pr.status}}</span> <span style="padding-left:15px">merging commits into {{pullrequest.target.name}} from {{pullrequest.source.name}}</span>  
        </div>
    {% endif %}
    <div class="container">

        <!-- Nav tabs -->
        <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#conversation">Conversation</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#commits">Commits</a>
        </li>
        </ul>
    
        <!-- Tab panes -->
        <div class="tab-content">
            <div class="tab-pane container active" id="conversation"> Pull request conversation history.</div>
            <div class="tab-pane container fade" id="commits">Commits history.</div>
        </div>
    </div>   
        <form style="margin-top: 20px; margin-left: -12px;" method="POST"> 
            {% csrf_token %}
            <hr>
            {% if pullrequest.status == 'Opened' %}
                <div class="card-header" style="border-color: green;">
                    {% bs_icon 'bezier2' size='1em' color='green' %} <a href="#" style="margin-left: 20px; margin-top: 10px; width: 200px; height: 50px; margin-bottom: 10px;" type="button" class="btn btn-success">Merge pull request</a>
                </div>
            {% elif pullrequest.status == 'Merged' %}
                <div class="card-header" style="border-color: purple;">
                    {% bs_icon 'bezier2' size='1em' color='purple' %}<span style="padding-left:15px; ">Pull request successfully merged and closed</span>
                    <br>
                    <span style="padding-left:35px;">You are all setâ€”the <b style="background-color: rgb(219, 216, 216);">{{pullrequest.source.name}} </b> branch can be safely deleted.</span><a href="#" style="margin-left: 20px; margin-top: 10px; width: 150px; margin-bottom: 10px;" type="button" class="btn btn-secondary">Delete branch</a>
                </div>
            {% else %}
                <div class="card-header" style="border-color: red;">
                    {% bs_icon 'pause' size='1em' color='red' %} <span style="padding-left:15px;">Closed with unmerged commits</span>
                    <br>
                    <span style="padding-left:35px;">This pull request is closed, but the <b style="background-color: rgb(219, 216, 216);">{{pullrequest.source.name}} </b> branch has unmerged commits.</span><a href="#" style="margin-left: 20px; margin-top: 10px; width: 150px; margin-bottom: 10px;" type="button" class="btn btn-secondary">Delete branch</a>
                </div>
            {% endif %}
            <hr>
            <div class="container">

                <!-- Nav tabs -->
                <ul class="nav nav-tabs">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="tab" href="#write">Write</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#preview">Preview</a>
                </li>
                </ul>
            
                <!-- Tab panes -->
                <div class="tab-content">
                    <div class="tab-pane container active" id="write"> 
                        <textarea class="form-control col-md-12" id="comment" rows="4" name="comment" placeholder="Leave a comment"></textarea>
                    </div>
                    <div class="tab-pane container fade" id="preview">Comments preview.</div>
                </div>
            </div>   
            <input type="submit" style="margin-left: 1000px; margin-top: 15px; margin-bottom: 20px;"  class="btn btn-success" value="Comment">
            {% if pullrequest.status == 'Closed' %}
                <a href="{% url 'changeStatusPullrequest' id=pullrequest.id %}" type="button" class="btn btn-outline-secondary" style="margin-left: 820px; margin-top: -58px; margin-bottom: 20px;">Reopen pull request </a>
            {% elif pullrequest.status == 'Opened' %}
                <a href="{% url 'changeStatusPullrequest' id=pullrequest.id %}" type="button" class="btn btn-outline-secondary" style="margin-left: 820px; margin-top: -58px; margin-bottom: 20px;">Close pull request </a>
            {% endif %}
        </form>
    {% else %}
    <p>There are no milestone with that id.</p>
    {% endif %}
    </div>  
    {% endblock %}
    </body>
</html>